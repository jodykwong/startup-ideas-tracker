import"./Layout.astro_astro_type_script_index_1_lang.rL_5vgxQ.js";const d=document.getElementById("signin-tab"),o=document.getElementById("signup-tab"),u=document.getElementById("signin-form"),g=document.getElementById("signup-form"),p=document.getElementById("switch-to-signup"),h=document.getElementById("switch-to-signin"),a=document.getElementById("auth-message");function b(){d?.classList.add("border-primary-500","text-primary-600"),d?.classList.remove("border-transparent","text-neutral-500"),o?.classList.remove("border-primary-500","text-primary-600"),o?.classList.add("border-transparent","text-neutral-500"),u?.classList.remove("hidden"),g?.classList.add("hidden"),p?.classList.remove("hidden"),h?.classList.add("hidden"),L()}function y(){o?.classList.add("border-primary-500","text-primary-600"),o?.classList.remove("border-transparent","text-neutral-500"),d?.classList.remove("border-primary-500","text-primary-600"),d?.classList.add("border-transparent","text-neutral-500"),g?.classList.remove("hidden"),u?.classList.add("hidden"),h?.classList.remove("hidden"),p?.classList.add("hidden"),L()}function n(t,e){a&&(a.textContent=t,a.className=`mt-4 p-3 rounded-lg ${e==="success"?"bg-success-100 text-success-800 border border-success-200":"bg-error-100 text-error-800 border border-error-200"}`)}function L(){a&&a.classList.add("hidden")}d?.addEventListener("click",b);o?.addEventListener("click",y);p?.addEventListener("click",y);h?.addEventListener("click",b);u?.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("signin-btn"),r=e?.querySelector(".signin-text"),i=e?.querySelector(".loading-spinner");r?.classList.add("hidden"),i?.classList.remove("hidden"),e?.setAttribute("disabled","true");try{const s=new FormData(t.target),c=await(await fetch("/api/auth/signin",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.get("email"),password:s.get("password")})})).json();c.success?(n("登录成功！正在跳转...","success"),setTimeout(()=>{window.location.href="/dashboard"},1e3)):n(c.error||"登录失败","error")}catch{n("网络错误，请重试","error")}finally{r?.classList.remove("hidden"),i?.classList.add("hidden"),e?.removeAttribute("disabled")}});g?.addEventListener("submit",async t=>{t.preventDefault();const e=document.getElementById("signup-btn"),r=e?.querySelector(".signup-text"),i=e?.querySelector(".loading-spinner"),s=new FormData(t.target),m=s.get("password"),c=s.get("confirmPassword");if(m!==c){n("密码不匹配","error");return}r?.classList.add("hidden"),i?.classList.remove("hidden"),e?.setAttribute("disabled","true");try{const l=await(await fetch("/api/auth/signup",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:s.get("email"),password:m})})).json();l.success?(n(l.message||"注册成功！","success"),l.data?.session&&setTimeout(()=>{window.location.href="/dashboard"},1e3)):n(l.error||"注册失败","error")}catch{n("网络错误，请重试","error")}finally{r?.classList.remove("hidden"),i?.classList.add("hidden"),e?.removeAttribute("disabled")}});
